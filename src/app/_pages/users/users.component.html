<ng-container>
    <div class="page-header">
        User Management
    </div>
</ng-container>

<div style="margin: 20px;border: 1px solid gray;">
    <table mat-table [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8">
        <ng-container matColumnDef="expand">
            <th mat-header-cell *matHeaderCellDef aria-label="row actions">&nbsp;</th>
            <td mat-cell *matCellDef="let element">
                <button mat-icon-button aria-label="expand row"
                    (click)="(expandedElement = expandedElement === element ? null : element); $event.stopPropagation()">
                    <mat-icon *ngIf="expandedElement !== element">keyboard_arrow_down</mat-icon>
                    <mat-icon *ngIf="expandedElement === element">keyboard_arrow_up</mat-icon>
                </button>
            </td>
        </ng-container>
        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplayWithExpand.length">
                <div class="example-element-detail"
                    [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                    <div class="example-element-description">

                        <form [formGroup]="element.form" (keydown.enter)="$event.preventDefault()">
                            <div class="flex justify-evenly mx-20px">
                                <div class="flex block">
                                    <mat-label class="label-mat-name">First Name - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="text" autocomplete="off" formControlName="firstName"
                                            placeholder="First Name" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('firstName').invalid && element.form.get('firstName').touched">
                                            <span *ngIf="element.form.get('firstName').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Maiden Name - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="text" autocomplete="off" formControlName="maidenName"
                                            placeholder="Maiden Name" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('maidenName').invalid && element.form.get('maidenName').touched">
                                            <span *ngIf="element.form.get('maidenName').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Last Name - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="text" autocomplete="off" formControlName="lastName"
                                            placeholder="Last Name" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('lastName').invalid && element.form.get('lastName').touched">
                                            <span *ngIf="element.form.get('lastName').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Age - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="number" autocomplete="off" formControlName="age"
                                            placeholder="Age" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('age').invalid && element.form.get('age').touched">
                                            <span *ngIf="element.form.get('age').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="flex justify-evenly mx-20px">
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Gender - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="text" autocomplete="off" formControlName="gender"
                                            placeholder="gender" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('gender').invalid && element.form.get('gender').touched">
                                            <span *ngIf="element.form.get('gender').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Email - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="email" autocomplete="off" formControlName="email"
                                            placeholder="email" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('email').invalid && element.form.get('email').touched">
                                            <span *ngIf="element.form.get('email').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Phone - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput type="text" autocomplete="off" formControlName="phone"
                                            placeholder="phone" />
                                        <mat-error align="start"
                                            *ngIf="element.form.get('phone').invalid && element.form.get('phone').touched">
                                            <span *ngIf="element.form.get('phone').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex block">
                                    <mat-label class="label-mat-name">Birthdate - </mat-label>
                                    <mat-form-field class="inp-mat" appearance="outline">
                                        <input matInput formControlName="birthDate" [matDatepicker]="picker1">
                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                        <mat-error align="start"
                                            *ngIf="element.form.get('birthDate').invalid && element.form.get('birthDate').touched">
                                            <span *ngIf="element.form.get('birthDate').errors['required']">
                                                This field is required.
                                            </span>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div>
                                <button mat-raised-button class="form-btn" [disabled]="!element.form.valid || isLoader"
                                    style="padding:20px;width: 100px;" (click)="updateRow(element.form, element)">
                                    <span *ngIf="!isLoader">Save</span>
                                    <span style="font-size: 30px;" *ngIf="isLoader"><i
                                            class="fa fa-spinner fa-spin"></i></span>
                                </button>
                                <button mat-raised-button class="form-btn" [disabled]="isLoader"
                                    style="padding: 20px;width: 100px;" (click)="cancel(element.form, element)">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </td>
        </ng-container>
        <ng-container matColumnDef="firstName">
            <th mat-header-cell *matHeaderCellDef> First Name </th>
            <td mat-cell *matCellDef="let element"> {{element.firstName}} </td>
        </ng-container>
        <ng-container matColumnDef="maidenName">
            <th mat-header-cell *matHeaderCellDef> Maiden Name </th>
            <td mat-cell *matCellDef="let element"> {{element.maidenName}} </td>
        </ng-container>
        <ng-container matColumnDef="lastName">
            <th mat-header-cell *matHeaderCellDef> Last Name </th>
            <td mat-cell *matCellDef="let element"> {{element.lastName}} </td>
        </ng-container>
        <ng-container matColumnDef="age">
            <th mat-header-cell *matHeaderCellDef> Age </th>
            <td mat-cell *matCellDef="let element"> {{element.age}} </td>
        </ng-container>
        <ng-container matColumnDef="gender">
            <th mat-header-cell *matHeaderCellDef> Gender </th>
            <td mat-cell *matCellDef="let element"> {{element.gender}} </td>
        </ng-container>
        <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef> Email </th>
            <td mat-cell *matCellDef="let element"> {{element.email}} </td>
        </ng-container>
        <ng-container matColumnDef="phone">
            <th mat-header-cell *matHeaderCellDef> Phone </th>
            <td mat-cell *matCellDef="let element"> {{element.phone}} </td>
        </ng-container>
        <ng-container matColumnDef="birthDate">
            <th mat-header-cell *matHeaderCellDef> Birthdate </th>
            <td mat-cell *matCellDef="let element"> {{element.birthDate | date:'dd-MM-yyyy' }} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
        <tr mat-row *matRowDef="let element; columns: columnsToDisplayWithExpand;" class="example-element-row"
            [class.example-expanded-row]="expandedElement === element"
            (click)="expandedElement = expandedElement === element ? null : element">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons aria-label="Select page">
    </mat-paginator>

</div>
